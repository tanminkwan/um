μΆ‹μµλ‹λ‹¤. μ”μ²­ν•μ‹  λ‚΄μ©μ„ κΈ°μ¤€μΌλ΅ \*\*"Microsoft 365 + MIP λΌλ²¨λ§ + Proxy μ¤‘κ³„ μ„λ²„ κΈ°λ°μ νμΌ λ³΄μ• μ²λ¦¬ μ‹μ¤ν…"\*\*μ„ μ¤‘μ‹¬μΌλ΅
β‘  **κΈ°μ κµ¬μ΅° μ„¤λ…**, β‘΅ **PowerShell κ°λ° μ—­ν• **, β‘Ά **κµμ΅μλ£μ© μ •λ¦¬λ³Έ**μ„ ν•λ‚μ κ°λ°μ κµμ΅ μ½ν…μΈ λ΅ κµ¬μ„±ν•΄λ“λ¦¬κ² μµλ‹λ‹¤.

---

# π“ **MIP κΈ°λ° λ¬Έμ„ λ³΄μ• μ²λ¦¬ μ•„ν‚¤ν…μ² λ° PowerShell μλ™ν™” μ‹¤μµ μλ£**

---

## π§­ **1. μ‹μ¤ν… κµ¬μ„± κ°μ”**

### π― λ©μ 

λ³΄μ•μ΄ μ¤‘μ”ν• μ‚¬λ‚΄λ§ ν™κ²½μ—μ„ μ‚¬μ©μκ°€ μ§μ ‘ Microsoft 365μ— μ ‘κ·Όν•μ§€ μ•κ³ ,
\*\*μ¤‘κ³„ μ„λ²„(Proxy μ„λ²„)\*\*λ¥Ό ν†µν•΄ **λ¬Έμ„ μ—…λ΅λ“ β†’ MIP λΌλ²¨λ§ β†’ λ‹¤μ΄λ΅λ“ β†’ λ°°ν¬** μ‘μ—…μ„ μν–‰ν•¨μΌλ΅μ¨
μ¤‘μ•™μ—μ„ **μ •λ³΄ λ³΄νΈλ¥Ό ν†µμ **ν•κ³  **λ³µνΈν™” μ΅°κ±΄μ„ μ μ–΄**ν•λ” κµ¬μ΅°μ…λ‹λ‹¤.

---

## π§± **2. μ „μ²΄ κΈ°μ  κµ¬μ΅° (Network + API)**

```plaintext
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”         β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”         β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ μ‚¬μ©μ PC    β”‚β”€β”€β”€β”€β”€β”€β”€β–¶β”‚ Proxy / μ¤‘κ³„ μ„λ²„   β”‚β”€β”€β”€β”€β”€β”€β”€β–¶β”‚ Microsoft 365       β”‚
β”‚ (μ‚¬λ‚΄λ§)     β”‚        β”‚ (μΈν„°λ„· μ—°κ²° κ°€λ¥) β”‚        β”‚ (Graph API, MIP λ“±) β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”         β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”         β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
       β–²                        β–Ό                                β–²
       β”‚ μ‚¬μ©μ λ¬Έμ„ μ μ¶       β”‚ PowerShell μ¤ν¬λ¦½νΈ μ‹¤ν–‰        β”‚ MIP λΌλ²¨/μ•”νΈν™” μ •μ±… μ κ³µ
       β–Ό                        β–Ό                                β–Ό
β•”β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•—
β•‘                       π” λ³΄νΈ νλ¦„ μ”μ•½                                 β•‘
β•‘ 1. μ‚¬μ©μ λ¬Έμ„ μ μ¶ β†’                                                   β•‘
β•‘ 2. Proxy μ„λ²„μ—μ„ λ¬Έμ„ μ—…λ΅λ“ (Graph API)                              β•‘
β•‘ 3. λ¬Έμ„μ— MIP λΌλ²¨ λ¶€μ°© (μ•”νΈν™” ν¬ν•¨ κ°€λ¥)                             β•‘
β•‘ 4. μ‚¬μ©μ λ‹¤μ΄λ΅λ“ or μ™Έλ¶€ λ°°ν¬ μ „ λ³µνΈν™” μ΅°κ±΄ κ²€μ¦ ν•„μ”               β•‘
β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•
```

---

## π§© **3. κµ¬μ„±μ”μ† μƒμ„Έ**

| κµ¬μ„± μ”μ†             | μ—­ν•                                                      |
| ----------------- | ------------------------------------------------------ |
| **μ‚¬μ©μ PC**        | μ‚¬λ‚΄λ§μ— μ„μΉ. λ¬Έμ„λ¥Ό Proxy μ„λ²„λ΅ μ „μ†΅ (μ›Ή νΌ, SMB, API λ“±μΌλ΅)          |
| **Proxy μ¤‘κ³„ μ„λ²„**   | PowerShellλ΅ Microsoft 365μ™€ ν†µμ‹ . μΈμ¦, μ—…λ΅λ“, λΌλ²¨λ§, λ‹¤μ΄λ΅λ“ λ“± μ²λ¦¬ |
| **Microsoft 365** | SharePoint/OneDriveμ— νμΌ μ €μ¥ λ° MIP κΈ°λ° λΌλ²¨λ§/μ•”νΈν™” μ •μ±… μ μ©      |
| **Azure RMS**     | μ•”νΈν™”λ λ¬Έμ„λ¥Ό μ—΄λ/λ³µνΈν™”ν•λ” κ¶ν• λ° usage rights λ°κΈ‰ μ£Όμ²΄              |
| **Graph API**     | λ¨λ“  μ‘μ—…(API νΈμ¶) μν–‰ λ„κµ¬. λ¬Έμ„ μ—…λ΅λ“, λ‹¤μ΄λ΅λ“, λΌλ²¨ λ¶€μ°© λ“± μ§€μ›          |
| **MIP SDK (μ„ νƒ)**  | Proxyμ—μ„ λ³µνΈν™” ν›„ μ²λ¦¬ν•κ±°λ‚ μ•”νΈν™” κ²€μ¦ν•  λ• μ‚¬μ© κ°€λ¥                    |

---

## β™οΈ **4. PowerShell κ°λ° ννΈ β€“ μ—­ν•  μ •μ**

| ννΈ               | κΈ°λ¥                                                  |
| ---------------- | --------------------------------------------------- |
| **1. μΈμ¦ μ²λ¦¬**     | Azure ADμ— λ“±λ΅λ AppμΌλ΅ OAuth2 ν† ν° νλ“                    |
| **2. λ“λΌμ΄λΈ νƒμƒ‰**   | OneDrive λλ” SharePointμ λ€μƒ λ¬Έμ„ν•¨ μ„μΉ μ΅°ν                |
| **3. νμΌ μ—…λ΅λ“**    | μ‚¬μ©μ λ¬Έμ„λ¥Ό Microsoft 365μ— μ—…λ΅λ“                          |
| **4. λΌλ²¨ λ¶€μ°©**     | `assignSensitivityLabel` APIλ΅ MIP λΌλ²¨ μ μ© (μ•”νΈν™” ν¬ν•¨ κ°€λ¥) |
| **5. λ‹¤μ΄λ΅λ“ μ²λ¦¬**   | λ³΄νΈλ νμΌμ„ λ‹¤μ‹ λ‹¤μ΄λ΅λ“ (μ•”νΈν™”λ μƒνƒ μ μ§€λ¨)                       |
| **6. ν”„λ΅μ‹ μ„¤μ • λ€μ‘** | μΈν„°λ„· μ ‘κ·Ό μ ν• ν™κ²½μ—μ„ ν”„λ΅μ‹ κ²½μ  μ„¤μ • ν¬ν•¨                         |

---

## π’» **5. PowerShell κµ¬μ„± κµ¬μ΅°**

```powershell
β”β”€β”€ config.ps1             # μ•± μΈμ¦ μ •λ³΄, ν”„λ΅μ‹ μ£Όμ†, κΈ°λ³Έ νλΌλ―Έν„° μ„¤μ •
β”β”€β”€ auth.ps1               # Access Token λ°κΈ‰ ν•¨μ
β”β”€β”€ drive-utils.ps1        # Drive ID μ΅°ν ν•¨μ (OneDrive, SharePoint κ³µμ©)
β”β”€β”€ upload-file.ps1        # νμΌ μ—…λ΅λ“ ν•¨μ
β”β”€β”€ apply-label.ps1        # MIP λΌλ²¨ λ¶€μ°© ν•¨μ
β”β”€β”€ download-file.ps1      # λ‹¤μ΄λ΅λ“ λ° μ €μ¥
β””β”€β”€ main.ps1               # μ „μ²΄ μ‹¤ν–‰ νλ¦„ ν†µν•© μ¤ν¬λ¦½νΈ
```

---

## π“ **6. κµμ΅μλ£ μ‹¤μµ μ‹λ‚λ¦¬μ¤**

### μ‹λ‚λ¦¬μ¤ A. μ‚¬μ©μκ°€ λ¬Έμ„λ¥Ό μ—…λ΅λ“ν•λ©΄ μλ™μΌλ΅ MIP λΌλ²¨ λ¶€μ°©

```bash
.\main.ps1 `
  -TargetType OneDrive `
  -UserPrincipalName kim@contoso.com `
  -RemotePath "κΈ°λ°€λ¬Έμ„/κ³„μ•½μ„.docx" `
  -LocalFile "C:\μ‚¬μ©μλ¬Έμ„\κ³„μ•½μ„.docx"
```

* OneDrive λ€μƒ μ‚¬μ©μμ λ“λΌμ΄λΈμ— μ—…λ΅λ“
* 'κΈ°λ°€' λΌλ²¨μ„ μλ™ λ¶€μ°© (μ•”νΈν™” ν¬ν•¨)
* λ‹¤μ΄λ΅λ“ νμΌμ€ μ•”νΈν™”λ μƒνƒλ΅ μ €μ¥λ¨

---

## π§  **7. κµμ΅ μ°Έκ³  ν¬μΈνΈ**

| μ£Όμ            | ν•µμ‹¬ ν¬μΈνΈ                                                        |
| ------------ | ------------------------------------------------------------- |
| Graph API κµ¬μ΅° | `https://graph.microsoft.com/v1.0/drives/{driveId}/items/...` |
| νμΌ λ³΄νΈ        | λΌλ²¨ μ μ© μ‹, μ‚¬μ©μκ°€ μ§€μ •λ κ¶ν•μ΄ μ—†μΌλ©΄ λ³µνΈν™” λ¶κ°€                              |
| λ³µνΈν™” νλ¦„       | Office μ•±μ€ Azure RMS ν† ν°μΌλ΅ μλ™ λ³µνΈν™”, μ„λ²„ μΈ΅μ€ MIP SDK ν•„μ”             |
| API νΈμ¶ νλ¦„    | μΈμ¦ β†’ λ“λΌμ΄λΈ μ΅°ν β†’ μ—…λ΅λ“ β†’ λΌλ²¨ μ μ© β†’ λ‹¤μ΄λ΅λ“                             |
| λΌλ²¨ μ μ© API    | `/assignSensitivityLabel` (Protected APIλ΅ μΉμΈ ν•„μ”)              |
| μ—λ¬ ν•Έλ“¤λ§       | 401 β†’ μΈμ¦ μ‹¤ν¨, 423 β†’ μ•”νΈν™”λ νμΌ λ®μ–΄μ“°κΈ°, 403 β†’ λΌλ²¨ κ¶ν• μ—†μ               |

---

## π“¦ **8. λ³΄μ• κ³ λ ¤μ‚¬ν•­ μ”μ•½**

| κµ¬λ¶„       | κ³ λ ¤μ‚¬ν•­                                          |
| -------- | --------------------------------------------- |
| μΈμ¦ λ³΄μ•    | μ•± λΉ„λ°€(Client Secret)μ€ Key Vault λλ” ν™κ²½ λ³€μ μ‚¬μ© κ¶μ¥ |
| λΌλ²¨ κ¶ν• μ ν• | μ΅°μ§ λ‚΄ λΌλ²¨ μ μ© κ°€λ¥ λ€μƒμ/μ•± κ¶ν• μ μ–΄ ν•„μ”                  |
| κ°μ‚¬ λ΅κ·Έ    | Proxy μ„λ²„μ— λΌλ²¨ μ μ©/λ‹¤μ΄λ΅λ“/μ—…λ΅λ“ λ΅κ·Έ λ³΄κ΄€                |
| μ™Έλ¶€ μ μ¶ λ°©μ§€ | MIP λΌλ²¨ + RMS μ•”νΈν™” μ •μ±…μ΄ μ μ¶ λ°©μ§€ ν•µμ‹¬ ν†µμ  μλ‹¨           |

---

## π“ μ°Έκ³  λ¦¬μ†μ¤

* [Microsoft Graph API Docs](https://learn.microsoft.com/en-us/graph/)
* [MIP Labeling Overview](https://learn.microsoft.com/en-us/microsoft-365/compliance/sensitivity-labels)
* [AssignSensitivityLabel API](https://learn.microsoft.com/en-us/graph/api/driveitem-assignsensitivitylabel)
* [MIP SDK](https://learn.microsoft.com/en-us/information-protection/develop/)

---

## β… κ²°λ΅ 

* μ΄ κµ¬μ΅°λ” **Proxy μ¥λΉ„κ°€ Microsoft 365μ— μ§μ ‘ μ—°κ²°λμ–΄ λΌλ²¨λ§/μ•”νΈν™”λ¥Ό μ μ–΄**ν•¨μΌλ΅μ¨,
  **μ‚¬μ©μ ν–‰λ™μ€ μ ν•ν•κ³  λ³΄μ• ν†µμ λ” μ¤‘μ•™ μ§‘μ¤‘ν™”**ν•λ” κµ¬μ΅°μ…λ‹λ‹¤.
* PowerShellμ€ κ·Έ κ³Όμ •μ—μ„ λ¨λ“  API νΈμ¶ λ° μλ™ν™”λ¥Ό λ‹΄λ‹Ήν•λ©°,
  **λ³΄μ• μ •μ±…, MIP ν†µν•©, μ—…λ΅λ“/λ‹¤μ΄λ΅λ“ νλ¦„μ μ—”μ§„ μ—­ν• **μ„ ν•©λ‹λ‹¤.

---

ν•„μ”ν•λ‹¤λ©΄ μ΄ κµμ΅μλ£λ¥Ό PDFλ‚ HTML λ¬Έμ„λ΅ ν¬λ§·ν…ν•κ±°λ‚,
μ‹¤μ  κµμ΅ μ„Έμ…μ© **μ¬λΌμ΄λ“** / **μ‹¤μµ μ•λ‚΄λ¬Έ**λ„ μ μ‘ λ„μ™€λ“λ¦΄ μ μμµλ‹λ‹¤.
μ–΄λ–¤ ν•μ‹μ΄ ν•„μ”ν•μ‹ μ§€ λ§μ”€ μ£Όμ„Έμ”!
